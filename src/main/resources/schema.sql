DROP TABLE IF EXISTS users, categories, spending CASCADE;

CREATE TABLE IF NOT EXISTS users (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR (50) NOT NULL,
	password VARCHAR NOT NULL,
	role VARCHAR NOT NULL,
	email VARCHAR NOT NULL
);

CREATE TABLE IF NOT EXISTS categories (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR (100) NOT NULL,
	expense BOOLEAN NOT NULL,
	user_id BIGINT REFERENCES users (id) ON DELETE CASCADE,
	CONSTRAINT uq_name UNIQUE (name)
);

CREATE TABLE IF NOT EXISTS spending (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	created TIMESTAMP NOT NULL,
	category BIGINT REFERENCES categories (id) ON DELETE CASCADE,
	note VARCHAR (200),
	quantity DOUBLE NOT NULL,
	user_id BIGINT REFERENCES users (id) ON DELETE CASCADE
);