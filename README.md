>Для реализации пет-проекта я хочу взять за основу свою Excel таблицу по финансам и реализовать удобный функционал по вводу данных о финансах, возможность их редактировать и просмотр автоматически созданного анализа.

При выполнении проекта, необходимо обратить особое внимание, на application.properties, на зависимости maven в pom.xml, чтобы не было лишних зависимостей и *жирности* итогового проекта.

Выполним декомпозицию крупной задачи и разобьём её на несколько маленьких.
## Проектирование базы данных

*В таблице хранения каждой записи с кол-вом траты или дохода будут следующие поля.*

**id** - уникальный идентификатор, генерируется автоматически для каждой записи.
**Дата** - по умолчанию будет добавляться текущая дата, если нужна другая дата, то у пользователя будет возможность указать другую дату.
**Категория** - в данное поле необходимо указывать категорию траты. Также это поле является внешнем ключом к таблице с категориями.  ~~Поле должно быть уникальным~~.
**Дополнительный комментарий** - в это поле можно указать примечание к трате или доходу, если это необходимо, поле может быть nulluble.  
**Кол-во** - собственно само значение денег.
**Пользователь** - в этом поле хранится внешний ключ на пользователя, который создал запись.

|id|Дата| Категория | Дополнительный комментарий |Кол-во|Пользователь|
|-|:-:|:---------:|:--------------------------:|:-:|:-:|
|1|18.12.2023|     1     |           Фрукты           |100|1|
|2|18.12.2023|     2     |                            |60000|1|
|3|18.12.2023|     3     |        Зубная нить         |150|1|

*Таблица категорий*.

**id** - уникальный идентификатор, генерируется автоматически для каждой записи.
**Наименование категории** - категорию можно создавать отдельно от таблицы, она должна быть уникальной и нужно стараться, чтобы категории не повторялись. Например, *еда* и *продукты* это одно и тоже, желательно, чтобы было какое-то одно наименование, чтобы в дальнейшем строился корректный отчет. Также можно будет попробовать реализовать функцию объединения нескольких категорий в одну с указанием одного названия в случае, если всё таки пользователь создал категории одинаковые по смыслу, но разные по наименованию.
**Трата** - это поле указывает на принадлежность записи к трате или доходу.
**Пользователь** - пользователь, который создал категорию

|id|Наименование категории|Трата|Пользователь|
|:-:|:-|:-:|:-:|
|1|Продукты|true|1|
|2|Аванс|false|1|
|3|Бытовое|true|1|

*Таблица пользователей.*

**id** - уникальный идентификатор, генерируется автоматически для каждой записи.
**Имя пользователя** - в данном поле указывается имя пользователя. Кроме того, в данную таблицу можно добавить различные поля с информацией о пользователе.

|id|Имя пользователя|Другие столбцы c информацией о пользователе|
|:-:|-|-|
|1|Дмитрий|День рождения, пол, и т.д.|

+ Файл schema.sql:
``` postgresql
DROP TABLE IF EXISTS users, categories, spending CASCADE;

CREATE TABLE IF NOT EXISTS users (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR (50) NOT NULL
);

CREATE TABLE IF NOT EXISTS categories (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR (100) NOT NULL,
	expense BOOLEAN NOT NULL,
	user_id BIGINT REFERENCES users (id) ON DELETE CASCADE,
	CONSTRAINT uq_name UNIQUE (name)
);

CREATE TABLE IF NOT EXISTS spending (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	created TIMESTAMP NOT NULL,
	category BIGINT REFERENCES categories (id) ON DELETE CASCADE,
	note VARCHAR (200),
	quantity DOUBLE NOT NULL,
	user_id BIGINT REFERENCES users (id) ON DELETE CASCADE	
);
```
## Структура проекта

∟ gateway
----∟ src
--------∟ main
------------∟ java
----------------∟ resources
------------∟ test
----∟ Dockerfile
----∟ pom.xml
∟ server
----∟ src
--------∟ main
------------∟ java
----------------∟ resources
------------∟ test
----∟ Dockerfile
----∟ pom.xml
∟pom.xml
∟docker-compose.yaml
∟readme
## Проектирование gateway

В сервис gateway будут приходить запросы приложению по REST API. В этом сервисе необходимо настроить валидацию входных данных. Здесь необходимо реализовать контроллеры по пользователям и по данным о тратах и доходах. Реализуем CRUD операции.

+ Пользователи (/users)
  post - создать пользователя, в теле запроса передать json
  get(/{userId}) - получить информацию о пользователе
  pacth(/{userId}) - обновить пользователя, в теле запроса передать json
  delete({userId}) - удалить пользователя

+ Категории (/categories)
  post - создать категорию, в теле передать json
  get - получить все категории
  pacth(/{categoriesId}) - обновить категорию, передать в заголовке
  pacth - объединить две категории категории
  delete(/{categoriesId}) - удалить категорию

+ Траты/доходы(/spending)
  post - создать запись, в заголовке указан пользователь, в теле json объекта spend
  get - получить записи (нужно подумать какие параметры передавать в запросе и какие будут варианты построения отчета)
  pacth(/{spendingId}) - обновление записи в таблице
  delete(/{spendingId}) - дадим пользователю возможность удалять некорректные записи
## Проектирование server

В сервисе server будет настроена логика и взаимодействие с базой данных. В этом сервисе также будут те же контроллеры, что и в gateway только без валидации, кроме той, которая нуждается в базе данных. Настроить при необходимости DTO, мапперы, поднять базу данных, настроить обработку исключений.
## Аутентификация пользователя

Если планируется запускать приложение как web, то необходимо подумать о аутентификации пользователя в приложении.
## Интерфейс пользователя

Нужно продумать интерфейс приложения, с которым пользователь будет взаимодействовать пользователь. Если удастся сделать это самостоятельно. Можно взять за основу пользовательского интерфейса Spring Web.
## Докер

Настроить докер для приложения с помощью docker-compose. Выбрать легковесные дистрибутивы для gateway, server и database. Настроить dockerfile для каждого сервиса.
## Тестирование
Тестирование необходимо выполнять на протяжении всей разработки приложения. Написать JUnit тесты, mock тестирование, интеграционное тестирование, написать автоматические тесты Postman.